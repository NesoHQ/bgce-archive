[
**Author:** @mahabubulhasibshawon
**Date:** 2025-07-29
**Category:** interview-qa/topic-wise/defer
**Tags:** [go, defer, channels]
]

# ЁЯФБ `defer` ржХрзА? (What is `defer` in Go)

Go-рждрзЗ `defer` ржПржоржи ржПржХржЯрж┐ рж╕рзНржЯрзЗржЯржорзЗржирзНржЯ ржпрж╛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрзЛржирзЛ ржлрж╛ржВрж╢ржи/рж╕рзНржЯрзЗржЯржорзЗржирзНржЯрзЗрж░ ржПржХрзНрж╕рж┐ржХрж┐ржЙрж╢ржиржХрзЗ ржмрж┐рж▓ржорзНржмрж┐ржд (delay) ржХрж░рзЗ ржпрждржХрзНрж╖ржг ржирж╛ ржЖрж╢рзЗржкрж╛рж╢рзЗрж░ (enclosing) ржлрж╛ржВрж╢ржиржЯрж┐ return ржХрж░рзЗ ржмрж╛ рж╢рзЗрж╖ рж╣ржпрж╝ред

ЁЯУМ рж╕рж╣ржЬржнрж╛ржмрзЗ ржмрж▓рж▓рзЗ:

> `defer` ржорж╛ржирзЗ: "ржПржЗ ржХрж╛ржЬржЯрж╛ ржкрж░рзЗ ржХрж░рзЛ, ржлрж╛ржВрж╢ржирзЗрж░ ржПржХрзЗржмрж╛рж░рзЗ рж╢рзЗрж╖рзЗ ржЧрж┐рзЯрзЗ ржХрж░рзЛред"

---

## ЁЯУж ржЙржжрж╛рж╣рж░ржг (Basic Example)

```go
package main
import "fmt"

func greet() {
	defer fmt.Println("World") // ржкрж░рзЗ ржЪрж╛рж▓рж╛ржмрзЗ
	fmt.Println("Hello")       // ржЖржЧрзЗ ржЪрж╛рж▓рж╛ржмрзЗ
}

func main() {
	greet()
}
```

**Output:**

```
Hello
World
```

> `fmt.Println("World")` ржПржХрзЗржмрж╛рж░рзЗ рж╢рзЗрж╖рзЗ execute рж╣ржпрж╝рзЗржЫрзЗ, ржХрж╛рж░ржг рж╕рзЗржЯрж┐ `defer` ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред

---

## тЪЩя╕П ржЖржнрзНржпржирзНрждрж░рзАржгржнрж╛ржмрзЗ ржХрзА ржШржЯрзЗ? (What happens under the hood)

* ржпржЦржи `defer` ржХрзЛржирзЛ ржлрж╛ржВрж╢ржирзЗрж░ ржнрзЗрждрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝, рждржЦржи Go ржХржорзНржкрж╛ржЗрж▓рж╛рж░ defer рж╕рзНржЯрзЗржЯржорзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ compile time ржП detect ржХрж░рзЗ ржПржмржВ Go runtime рж╕рзЗржЗ рж╕рзНржЯрзЗржЯржорзЗржирзНржЯ ржмрж╛ ржлрж╛ржВрж╢ржи ржХрж▓ржЯрж┐ ржПржХржЯрж┐ **stack**-ржП рж░рзЗржЦрзЗ ржжрзЗржпрж╝ред
* ржпржЦржи ржлрж╛ржВрж╢ржиржЯрж┐ рж╢рзЗрж╖ рж╣ржпрж╝ (return, panic ржмрж╛ рж╢рзЗрж╖ рж▓рж╛ржЗржирзЗ ржкрзМржБржЫрж╛ржпрж╝), рждржЦржи stack-ржП рж░рж╛ржЦрж╛ `defer` ржЧрзБрж▓рзЛ **LIFO (Last In First Out)** ржЕрж░рзНржбрж╛рж░рзЗ execute рж╣ржпрж╝ред

### ржЙржжрж╛рж╣рж░ржг:

```go
func example() {
	defer fmt.Println("1")
	defer fmt.Println("2")
	defer fmt.Println("3")
}
```

**Output рж╣ржмрзЗ:**

```
3
2
1
```

ЁЯСЙ ржХрж╛рж░ржг рж╕ржм `defer` рж╕рзНржЯрзЗржЯржорзЗржирзНржЯ stack-ржП ржврзБржХрзЗржЫрзЗ ржПржЗржнрж╛ржмрзЗ:

```
push "1"
push "2"
push "3"
```

ржЖрж░ execute рж╣ржЪрзНржЫрзЗ LIFO ржЕрж░рзНржбрж╛рж░рзЗ:

```
pop "3"
pop "2"
pop "1"
```

---

## ЁЯза Defer ржПрж░ ржХрж┐ржЫрзБ рж╕рж╛ржзрж╛рж░ржг ржмрзНржпржмрж╣рж╛рж░

| ржкрзНрж░рзЯрзЛржЧ          | ржмрзНржпрж╛ржЦрзНржпрж╛                                           |
| --------------- | -------------------------------------------------- |
| ржлрж╛ржЗрж▓ ржмржирзНржз ржХрж░рж╛   | `defer file.Close()` I/O operation рж╢рзЗрж╖рзЗ            |
| ржорзЗржорж░рж┐ ржорзБржХрзНржд ржХрж░рж╛ | `defer free(ptr)` ржмрж╛ resource release              |
| unlock ржХрж░рж╛      | `defer mu.Unlock()` mutex ржмрж╛ lock handle ржХрж░рж╛рж░ рж╕ржоржпрж╝ |
| recover()       | panic рж╣рж▓рзЗ graceful error handle ржХрж░рждрзЗ               |

---

## тЬЕ FAQs (Frequently Asked Questions)

### 1. **ржПржХрж╛ржзрж┐ржХ `defer` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзЛржиржЯрж╛ ржЖржЧрзЗ ржЪрж╛рж▓рж╛ржмрзЗ?**

ЁЯСЙ рж╢рзЗрж╖ ржпрзЗржЯрж╛ `defer` рж╣ржпрж╝рзЗржЫрзЗ, рж╕рзЗржЯрж╛ржЗ ржЖржЧрзЗ ржЪрж╛рж▓рж╛ржмрзЗ (LIFO order)ред

```go
defer fmt.Println("first")
defer fmt.Println("second")
```

**Output:**

```
second
first
```

---

### 2. **defer ржХрзАржнрж╛ржмрзЗ stack ржП ржХрж╛ржЬ ржХрж░рзЗ?**

Go runtime `defer` рж╕рзНржЯрзЗржЯржорзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ ржПржХржЯрж╛ internal stack-ржП рж░рж╛ржЦрзЗред ржпрждржмрж╛рж░ рждрзБржорж┐ `defer` рж▓рзЗржЦрзЛ, рж╕рзЗржЯрж┐ рж╕рзЗржЗ stack-ржП push рж╣ржпрж╝ред ржлрж╛ржВрж╢ржи return ржХрж░рж╛рж░ рж╕ржоржпрж╝, stack ржерзЗржХрзЗ pop ржХрж░рзЗ ржПржХрзЗ ржПржХрзЗ ржЪрж╛рж▓рж╛ржирзЛ рж╣ржпрж╝ред

---

### 3. **defer ржлрж╛ржВрж╢ржирзЗ ржпржжрж┐ ржЖрж░рзНржЧрзБржорзЗржирзНржЯ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржХржЦржи рж╕рзЗржЯрж┐ evaluate рж╣ржпрж╝?**

ЁЯСЙ `defer` ржПрж░ ржлрж╛ржВрж╢ржи **call time ржП evaluate рж╣ржпрж╝, execute time ржП ржиржпрж╝**ред

```go
func main() {
	x := 10
	defer fmt.Println("x =", x)
	x = 20
}
```

**Output:**

```
x = 10
```

ЁЯУМ ржХрж╛рж░ржг `x` ржПрж░ ржорж╛ржи `defer` рж▓рж╛ржЗржирзЗрж░ рж╕ржоржпрж╝ржЗ ржХрзНржпрж╛ржкржЪрж╛рж░ рж╣ржпрж╝рзЗржЫрзЗ, ржкрж░рзЗ `x = 20` рж╣рж▓рзЗржУ рждрж╛ ржкрзНрж░ржнрж╛ржм ржлрзЗрж▓рзЗ ржирж╛ред

---

### 4. **defer ржлрж╛ржВрж╢ржирзЗ anonymous function ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржпрж╝?**

рж╣рзНржпрж╛ржБ, ржпрж╛ржпрж╝:

```go
defer func() {
	fmt.Println("Deferred anonymous function")
}()
```

---

### 5. **performance impact ржЖржЫрзЗ ржХрж┐?**

рж╣рж╛рж▓ржХрж╛ performance overhead ржЖржЫрзЗ ржХрж╛рж░ржг `defer` рж╕рзНржЯрзЗржЯржорзЗржирзНржЯ stack ржП ржпрж╛ржпрж╝ред рждрж╛ржЗ performance-critical ржХрзЛржбрзЗ рж╣рж╛ржЬрж╛рж░ рж╣рж╛ржЬрж╛рж░ `defer` ржмрзНржпржмрж╣рж╛рж░ ржирж╛ ржХрж░рж╛ржЗ ржнрж╛рж▓рзЛред

---

### 6. **panic рж╣рж▓рзЗ ржХрж┐ `defer` ржлрж╛ржВрж╢ржи execute рж╣ржпрж╝?**

рж╣рзНржпрж╛ржБ! panic рж╣рж▓рзЗржУ `defer` ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛ execute рж╣ржпрж╝ред ржПржЯрж┐ржЗ `defer` ржПрж░ ржПржХржЯрж┐ ржмржбрж╝ рж╕рзБржмрж┐ржзрж╛ред

```go
func test() {
	defer fmt.Println("Deferred cleanup")
	panic("Something went wrong")
}
```

**Output:**

```
Deferred cleanup
panic: Something went wrong
```

---

### 7. **defer return value-ржХрзЗ modify ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржХрж┐?**

рж╣рзНржпрж╛ржБ, ржпржжрж┐ named return variable ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ред

```go
func example() (result int) {
	defer func() {
		result += 1
	}()
	return 10
}
```

**Output:**

```
11
```

---

## ЁЯПБ ржЙржкрж╕ржВрж╣рж╛рж░ (Conclusion)

* `defer` ржлрж╛ржВрж╢ржирзЗрж░ рж╢рзЗрж╖ ржорзБрж╣рзВрж░рзНрждрзЗ clean-up ржмрж╛ final task ржХрж░рж╛рж░ ржЬржирзНржп ржЦрзБржм ржЙржкржХрж╛рж░рзАред
* ржПржЯрж┐ stack-ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ (LIFO order)ред
* ржЕржзрж┐ржХрж╛ржВрж╢ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржПржЯрж┐ ржХрзЛржбржХрзЗ ржкрж░рж┐рж╖рзНржХрж╛рж░, ржХржо bug-ржкрзНрж░ржмржг ржУ predictable ржХрж░рзЗ рждрзЛрж▓рзЗред

